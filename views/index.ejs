<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>311 Call Data</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

  <!-- Optional: Your styles -->
  <link rel="stylesheet" href="/styles.css" />

  <!-- Bootstrap Bundle JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <div class="container my-4 text-center">

    <div class="row mb-4">
      <div class="col">
        <h1>311 Call Volume by Category</h1>
      </div>
    </div>

    <div class="row">
      <!-- Form column -->
      <div class="col-12 col-md-4 mb-3">
        <form action="/submit" method="POST" class="d-flex flex-column align-items-start gap-2">
          <label for="queueSelect" class="form-label fw-semibold">Select Queue Name:</label>
          <select id="queueSelect" name="queueName" class="form-select w-100">
        
            <% for (const queue in content) { %>
              <option value="<%= queue %>"><%= queue %></option>
            <% } %>
          </select>
          <button type="submit" class="btn btn-primary mt-2 w-100">Submit</button>
        </form>
      </div>

      <!-- Chart column -->
      <div class="col-12 col-md-8">
        <canvas id="myChart" style="max-width: 100%; height: 100%;"></canvas>
      </div>
    </div>
  </div>

  <!-- Safely store chart data -->
  <script id="chart-data" type="application/json">
    <%- JSON.stringify(dataChart) %>
  </script>

  <script>
    const chartData = JSON.parse(document.getElementById('chart-data').textContent);
    const ctx = document.getElementById('myChart').getContext('2d');

    new Chart(ctx, {
      type: 'pie',
      data: chartData,
      options: {
        plugins: {
          legend: {
            position: 'bottom',
            labels: {
              boxWidth: 15,
              padding: 10,
            },
          },
        },
        responsive: true,
        maintainAspectRatio: false,
      },
    });
  </script>
</body>
</html>